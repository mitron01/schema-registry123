# go-jsonschema — инструмент генерации Go-кода из JSON Schema

## 1. Основное описание
`go-jsonschema` — CLI‑утилита для генерации Go‑кода по JSON Schema. Инструмент умеет работать как с отдельными файлами схем, так и в режиме объединения(объединяет json-схемы директории в одну, а затем производит генерацию по нему)

## 2. Что делает инструмент
- Загружает одну или несколько JSON‑схем.
- **Режим мержа** обходит **относительные** `$ref` и подтягивает схемы из других файлов/директорий.
- Переписывает внешние ссылки в локальные `#/definitions/...`, выносит все `$defs/definitions` в общий пул.
- Готовит объединённую схему и генерирует по ней Go‑код.
- Позволяет настраивать пакет, имя выходного файла, корневой тип и т.д.

> Примечание: базовые возможности генерации (теги, капитализация, sized‑ints и пр.) — такие же, как у оригинального `go-jsonschema` (форк atombender/omissis).

## 3. Использование инструмента

### Базовая генерация по одному или нескольким файлам
```bash
./go-jsonschema \
  -p mypkg \
  -o ./out/models.go \
  ./schemas/a.schema.json ./schemas/b.schema.json
```

### Генерация в режиме объединения (директории)
```bash
./go-jsonschema \
  -p mypkg \
  -o ./out/infra.models.go \
  --merge-files \
  json/mw
```
В режиме `--merge-files` каждый позиционный аргумент это **директория**. Утилита рекурсивно соберёт все файлы, подтянет относительные `$ref`, замкнёт их в локальные определения и сгенерирует код по результирующей схеме.

## 4. Опции
- `-v, --verbose` — подробный лог работы.
- `-e, --extra-imports` — разрешить дополнительные импорты (не из стандартной библиотеки).
- `--only-models` — генерировать только модели (без валидации/методов).
- `-p, --package <NAME>` — имя Go‑пакета по умолчанию (если не задано через `--schema-package`).
- `-o, --output <FILE>` — путь вывода по умолчанию (если не задано через `--schema-output`). Для `--merge-files` используется как файл вывода объединённой генерации.
- `--schema-package URI=PACKAGE` — пакет для конкретной схемы.
- `--schema-output  URI=FILENAME` — файл вывода для конкретной схемы.
- `--schema-root-type URI=TYPE` — имя корневого типа для конкретной схемы.
- `--capitalization VALUE` — предпочитаемая капитализация идентификатора (флаг можно повторять).
- `--resolve-extension EXT` — дополнительные расширения для поиска файлов по `$ref` (можно несколько).
- `--yaml-extension EXT` — распознавать как YAML (по умолчанию: `.yml`, `.yaml`; можно добавить свои).
- `-t, --struct-name-from-title` — использовать `title` из схемы как имя генерируемой структуры.
- `--tags tag1,tag2,...` — список генерируемых тегов (по умолчанию: `json,yaml,mapstructure`).
- `--min-sized-ints` — подбирать размеры `int/uint` по min/max полю.
- `--disable-readonly-validation` — отключить валидацию `readOnly` полей.
- `--minimal-names` — использовать максимально короткие имена.
- `--disable-custom-types-for-maps` — не генерировать кастомные типы для карт.
- `--merge-files` — режим объединения: собирать файлы/директории, подтягивать `$ref`, мержить и генерировать по единому результату.

## 5. Примеры
### 5.1. Простая генерация одной схемы
```bash
./go-jsonschema -p test -o ./out/single.go ./schemas/user.schema.json
```

### 5.2. Генерация нескольких схем без мержа
```bash
./go-jsonschema -p test -o ./out/models.go ./schemas/a.schema.json ./schemas/b.schema.json
```

### 5.3. Генерация мержа файлов директории
```bash
./go-jsonschema \1
  -p mwinfra \
  -o ./out/infra.go \
  --merge-files \
  ./data/merged/json/mw/infra 
  ```